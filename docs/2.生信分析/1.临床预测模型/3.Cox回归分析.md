---
title: 生信技术 | 临床预测模型 —— Cox比例风险回归模型
createTime: 2025/01/13 20:27:03
permalink: /article/clinical-prediction-model/Cox/

tags:
  - R语言
  - 生信分析
  - 生信技术
  - 生存分析
  - Cox回归
  - 资源列表
  - 学习代码

cover: "https://10.idqqimg.com/qqcourse_logo_ng/ajNVdqHZLLAZUickfeQQkX3yicRVMoJicwTCgYSdg9QUYE6nn5Gb5qM0U4vMKykfpJ3g1JKiaWVGk3Y/600"
# sticky: 100000
---
Cox 比例风险模型是临床医学研究中常用的统计回归模型，用于调查患者生存时间与一个或多个预测变量之间的关联，评估风险因素对生存时间的影响。
<!-- more -->

![](https://10.idqqimg.com/qqcourse_logo_ng/ajNVdqHZLLAZUickfeQQkX3yicRVMoJicwTCgYSdg9QUYE6nn5Gb5qM0U4vMKykfpJ3g1JKiaWVGk3Y/600)

## **前言**
::: tip 临床预测模型
- 临床预测模型（Clinical prediction models）是根据一组患者特征（“预测变量”）计算结果风险的工具，可用于为个体的**诊断**或**预后**提供信息。
- 作为风险分层的量化工具，临床预测模型可为医生、患者以及医疗保健政策制定者的决策提供更为有依据的信息。 
- 临床预测模型通常利用多因素模型估算患有某病的概率或者将来某结局发生的概率，目的是实现对结局的最精确的预测，而不着重于考虑其各个组成部分与结局之间的关联，根据不同目的和设计主要包括**诊断模型（Diagnostic models）**和**预后模型（Prognostic models）**。
- **诊断模型**通常基于横断面资料中研究对象的临床症状和特征，诊断当前患有某种疾病的概率；
- **预后模型**通常基于纵向队列研究资料，基于当前状况下（可以是健康或患病），判断未来一段时间内发生某一结局（发病、复发、死亡，伤残及并发症）的风险。
:::

::: tip 预测模型的研究步骤
**① 确定预测变量，提取并处理相关数据**
- 预测变量的确认需结合临床及既往研究，通常纳入较为公认的预测因子
- 在临床研究中，根据研究目的会加上待研究预测因子，以提高预测准确度
- 确认预测变量后，从数据集中提取相关数据，处理缺失值、离群值等，结合数据类型及后续需求进行变量的归一化、标准化等处理

**② 筛选预测变量纳入预测模型**
- 前一步纳入的预测因子通常总数量较多，在纳入模型之前会进一步筛选，筛选方法主要为**各类统计学手段**，例如传统的**单因素分析**以及当前较为热门的**机器学习**与**深度学习**方法；

**③拟合预测模型**
- 该步骤的关键是模型的选择，预测模型的类型取决于感兴趣的结局
- **logistic回归模型**用于二分类结局，如有无疾病（如是否发生帕金森病）或确定时间段的结局事件；
- **Cox比例风险回归模型**用于包含时间的数据（如帕金森病患者进展到帕金森病痴呆）；
- **机器学习与深度学习**方法，如随机森林、k近邻、支持向量机和人工神经网络等，也越来越多地用于预测模型的开发；

**④预测模型的评估**
- 包括**内部验证**（如随机划分训练、测试与验证集，k折交叉验证，置换检验等）及**外部验证**（如外部队列验证）
:::

## **Cox比例风险回归模型**
::: tip Cox比例风险回归模型构建过程
- 根据研究设计，确定待研究预测变量之后，Cox比例风险回归模型需要按如下步骤进行：变量筛选、最佳模型的建立、预测模型评估
:::


## **模型预测性能评价与比较**

::: tip 模型性能评价
一个**好的疾病风险预测模型**不仅要有很好的**区分度**，同时还要具备良好的**校准度**
- **区分度（Discrimination）：**
   
   - 一个好的疾病风险预测模型，能够把未来发病风险高、低不同的人群正确地区分开来
   - 预测模型通过设置一定的风险界值，高于界值判断为发病，低于界值则判断为不发病，从而正确区分个体是否会发生结局事件，这就是预测模型的区分度。评价预测模型区分能力的指标，最常用的就是AUC，也叫C统计量（C-statistics）。AUC越大，说明预测模型的判别区分能力越好。一般AUC < 0.6认为区分度较差，0.6-0.75认为模型有一定的区分能力，> 0.75认为区分能力较好。



校准度（Calibration）：是评价一个疾病风险模型预测未来某个个体发生结局事件概率准确性的重要指标，它反映了模型预测风险与实际发生风险的一致程度，所以也可以称作为一致性。校准度好，提示预测模型的准确性高，校准度差，则模型有可能高估或低估疾病的发生风险。在实际的应用中，通常用拟合优度检验（Hosmer-Lemeshow good of fit test）来评价预测模型的校准度。若检验结果显示有统计学显著性（P < 0.05），则表明模型预测值和实际观测值之间存在一定的差异，模型校准度差。
:::


## **ROC曲线**
::: info ROC曲线

:::

## **校准曲线**
::: info 校准曲线
:::

## **决策曲线(DCA曲线)**

::: info 决策曲线(DCA曲线)
:::

## **决策曲线(DCA曲线)**

::: info 临床影响曲线
:::

## **森林图**

::: info 森林图
:::

## **列线图**

::: info 列线图
:::

## **参考资源**

- <Badge type="warning" text="基础教程" />[STHDA | Cox比例风险模型](https://www.sthda.com/english/wiki/cox-proportional-hazards-model)

- <Badge type="warning" text="基础教程" />[生存分析](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg3ODg5MzU5NA==&action=getalbum&album_id=2889328751862562819&scene=173&subscene=&sessionid=svr_43ed59eea8d&enterid=1736779308&from_msgid=2247485275&from_itemidx=1&count=3&nolastread=1#wechat_redirect)
- <Badge type="warning" text="基础教程" />[超详细！单因素、多因素COX回归分析在R中的实现与常见问题解答](https://zhuanlan.zhihu.com/p/645916220)
- <Badge type="warning" text="基础教程" />[R语言实战临床预测模型](https://ayueme.github.io/R_clinical_model/)

- <Badge type="danger" text="进阶教程" />[cox模型评估-决策曲线分析（DCA）](https://www.omicsclass.com/article/1528)
- <Badge type="danger" text="进阶教程" />[继ROC及列线图之后---校准曲线、DCA决策曲线、临床影响曲线](https://zhuanlan.zhihu.com/p/627088921)
- <Badge type="danger" text="进阶教程" />[COX回归模型的决策曲线分析（DCA）](https://zhuanlan.zhihu.com/p/698554321)
- <Badge type="danger" text="进阶教程" />[cox构建预测模型——seer数据库复现](https://www.bilibili.com/read/readlist/rl743806?spm_id_from=333.1369.opus.module_collection.click)
- <Badge type="danger" text="进阶教程" />[R语言基于dcurves包绘制COX回归临床决策曲线]()
- <Badge type="danger" text="进阶教程" />[COX回归模型的决策曲线分析（DCA）](https://zhuanlan.zhihu.com/p/698554321)
- <Badge type="danger" text="进阶教程" />[生信技术 | 临床预测模型之Cox比例风险回归模型](https://mp.weixin.qq.com/s?__biz=Mzg2NDgzMDE1Ng==&mid=2247495799&idx=1&sn=2837474b20d0590e13efeeae0bb30587&chksm=ce61e7d4f9166ec2d4d5b78ed6a963dec1f1178ac5e7aecef8d77391823c58ca30ab7cf9e12d&scene=27)
- <Badge type="danger" text="进阶教程" />[]()
